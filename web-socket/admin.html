<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Admin Chat</title>
  </head>
  <body>
    <h2>Admin Panel</h2>
    <div
      id="messages"
      style="
        border: 1px solid gray;
        padding: 10px;
        height: 200px;
        overflow: auto;
      "
    ></div>
    <input id="userId" placeholder="User ID (from message)" />
    <input id="msg" placeholder="Type reply..." style="width: 60%" />
    <button onclick="send()">Send</button>

    <script>
      const ws = new WebSocket("ws://localhost:3000/ws/admin");
      const messagesDiv = document.getElementById("messages");

      ws.onopen = () => {
        messagesDiv.innerHTML += "<p><b>Admin connected</b></p>";
      };

      ws.onmessage = (event) => {
        const data = JSON.parse(event.data);
        messagesDiv.innerHTML += `<p><b>${data.from}:</b> ${data.content}</p>`;
      };

      function send() {
        const userId = document.getElementById("userId").value;
        const msg = document.getElementById("msg").value;

        const payload = {
          to: userId,
          content: msg,
          user_type: "admin",
        };

        ws.send(JSON.stringify(payload));
        messagesDiv.innerHTML += `<p><b>To ${userId}:</b> ${msg}</p>`;
        document.getElementById("msg").value = "";
      }
    </script>
  </body>
</html>
